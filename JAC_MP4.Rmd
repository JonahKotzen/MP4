---
title: "MP4"
author: "Jonah Kotzen, Ava Skogstrom, Conor Booth"
date: "2024-04-17"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(tibble)
```

```{r read average, include=FALSE}
alcidae <- read.table("Booth_Kotzen_Skogstrom_alcid.txt", sep = ",", header = TRUE)
laridae <- read.table("Booth_Kotzen_Skogstrom_larid.txt", sep = ",", header = TRUE)

```

# Total Wing Area (A)
We used the ruler and shape info features in SketchUp to determine A
A = chord (c) *x* span (s) (an approximation)
Laridae: c = 20.6623 mm, s = 60.1978 mm, A = 1243.825 sq mm
Alcidae: c = 42 mm, s = 52 mm, A = 2184 sq mm

# Span (S)
We used the ruler and shape info features in SketchUp to determine S
Laridae: 60.1978 mm
Alcidae: 52 mm

# Wetted Area (Aw)
We used the ruler and shape info features in SketchUp to determine Aw
The wetted area is surface area of the wing in contact with the air flow
Laridae: 165.368118 sq mm
Alcidae: 104 sq mm

```{r calc, include=FALSE}

wing_data <- tibble(
  Bird_Family = c("Laridae", "Alcidae"),
  Chord_mm = c(20.6623, 42),
  Span_mm = c(60.1978, 52),
  Total_Wing_Area_sq_mm = c(1243.825, 2184),
  Wetted_Area_sq_mm = c(165.368118, 104)
)

```

# Compiled Wing Data into Tibble

```{r wing, include=TRUE}
wing_data
```

# Comparison of Wing Areas b/w Specimens

```{r graph 0, include=TRUE}
ggplot(wing_data, aes(x = Bird_Family)) +
  geom_bar(aes(y = Total_Wing_Area_sq_mm, fill = "Total Wing Area"), stat = "identity", position = "dodge") +
  geom_bar(aes(y = Wetted_Area_sq_mm, fill = "Wetted Area"), stat = "identity", position = "dodge") +
  labs(title = "Comparison of Wing Areas",
       x = "Bird Family",
       y = "Area (sq mm)",
       fill = "Area Type") +
  theme_minimal()

```


# Comparison of Lift over Time b/w Specimens

```{r graph 1, include=TRUE}

ggplot() +
  geom_line(data = alcidae, aes(x = s, y = lift, color = "Alcidae Lift"), size = 1) +
  geom_line(data = laridae, aes(x = s, y = lift, color = "Laridae Lift"), size = 1) +
  labs(title = "Comparison of Lift over Time", x = "Time (s)", y = "Lift Force (N)") +
  scale_color_manual(values = c("Alcidae Lift" = "blue", "Laridae Lift" = "green")) +
  theme_minimal()

```

# Comparison of Drag over Time b/w Specimens

```{r graph 2, include=TRUE}

ggplot() +
  geom_line(data = alcidae, aes(x = s, y = drag, color = "Alcidae Drag"), size = 1) +
  geom_line(data = laridae, aes(x = s, y = drag, color = "Laridae Drag"), size = 1, linetype = "dashed") +
  labs(title = "Comparison of Drag over Time", x = "Time (s)", y = "Drag Force (N)") +
  scale_color_manual(values = c("Alcidae Drag" = "red", "Laridae Drag" = "purple")) +
  theme_minimal()
```

# Calculations

```{r calculations1, include=FALSE}
# Calculate averages for Alcidae
average_lift_alcidae <- mean(alcidae$lift)
average_drag_alcidae <- mean(alcidae$drag)

# Calculate averages for Laridae
average_lift_laridae <- mean(laridae$lift)
average_drag_laridae <- mean(laridae$drag)

# Create a tibble with average lift and drag for both bird families
averages_tibble <- tibble(
  Bird_Family = c("Alcidae", "Laridae"),
  Average_Lift = c(average_lift_alcidae, average_lift_laridae),
  Average_Drag = c(average_drag_alcidae, average_drag_laridae)
)
```

```{r calc2, include=TRUE}
averages_tibble
```

# Calculate Coefficients and Perform Comparative Analysis

```{r comparative, include=TRUE}

# Join the data using Bird_Family as the key
complete_data <- left_join(wing_data, averages_tibble, by = "Bird_Family")

# Now calculate the coefficients and other values needed
# Using fluid density for water (1000 kg/m^3) and fluid velocity (16 cm/s converted to m/s)
fluid_density <- 1000
fluid_velocity <- 16 / 100  # cm/s to m/s

# Calculate drag and lift coefficients
complete_data$C_D <- complete_data$Average_Drag / (0.5 * fluid_density * fluid_velocity^2 * (complete_data$Total_Wing_Area_sq_mm / 1e6))  # Convert mm^2 to m^2
complete_data$C_L <- complete_data$Average_Lift / (0.5 * fluid_density * fluid_velocity^2 * (complete_data$Total_Wing_Area_sq_mm / 1e6))

# Calculate the lift-to-drag ratio
complete_data$L_to_D_ratio <- complete_data$C_L / complete_data$C_D

# Calculate the aspect ratio (AR)
complete_data$AR <- (complete_data$Span_mm / 1000)^2 / (complete_data$Wetted_Area_sq_mm / 1e6)  # Convert mm to m for S and Aw

# Print the updated tibble with all calculations
print(complete_data)

```
```{r visual, include=TRUE}
# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Plot for Drag Coefficient
p1 <- ggplot(complete_data, aes(x = Bird_Family, y = C_D, fill = Bird_Family)) +
  geom_col() +
  labs(title = "Drag Coefficient (C_D)", y = "Coefficient of Drag") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1")

# Plot for Lift Coefficient
p2 <- ggplot(complete_data, aes(x = Bird_Family, y = C_L, fill = Bird_Family)) +
  geom_col() +
  labs(title = "Lift Coefficient (C_L)", y = "Coefficient of Lift") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1")

# Plot for Lift-to-Drag Ratio
p3 <- ggplot(complete_data, aes(x = Bird_Family, y = L_to_D_ratio, fill = Bird_Family)) +
  geom_col() +
  labs(title = "Lift-to-Drag Ratio", y = "L_to_D_ratio") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1")

# Plot for Aspect Ratio
p4 <- ggplot(complete_data, aes(x = Bird_Family, y = AR, fill = Bird_Family)) +
  geom_col() +
  labs(title = "Aspect Ratio (AR)", y = "Aspect Ratio") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set1")

# Arrange the plots in a grid
grid.arrange(p1, p2, p3, p4, ncol = 2, nrow = 2)


```

# Interpretations

# References
